import{k as l,v as p,a as h,A as c}from"./index-DnGQr7Lo.js";async function m(s,a=5e3){try{const o=await l.post("https://leme.myqnapcloud.com:60502/api/get-products",{limit:100},{timeout:a,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}});return p(o.data)}catch(o){throw new Error("Error en el servicio: "+o.message)}}async function E(s,a,o=5e3){try{const n=await l.post("https://leme.myqnapcloud.com:60502/api/delete-product",{id:a},{timeout:o,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}});return p(n.data)}catch(n){throw new Error("Error en el servicio: "+n.message)}}async function g(s,a,o,n,i,e,r=5e3){try{const t=new FormData;t.append("title",a),t.append("subtitle",o),t.append("description",n),t.append("price",i),t.append("image",e);const d=await l.post("https://leme.myqnapcloud.com:60502/api/add-product",t,{timeout:r,headers:{"Content-Type":"multipart/form-data; charset=UTF-8",Authorization:`Bearer ${s}`}});return p(d.data)}catch(t){throw new Error("Error en el servicio: delProductService"+t.message)}}function z(){const{token:s,onTokenExpired:a}=h();async function o(){try{let e=await m(s);return e.code===c.DB_QUERY_SUCCESS?{success:!0,unauthorized:!1,products:e.data}:e.code===c.TOKEN_EXPIRED||e.code===c.TOKEN_FAIL?(a(),{success:!1,unauthorized:!0,message:"Token inválido o expirado"}):{success:!1,unauthorized:!1,message:"Error al obtener los datos!"}}catch(e){return{success:!1,unauthorized:!1,message:e.message}}}async function n(e){try{const r=await E(s,e);return r.code===c.DB_QUERY_SUCCESS?{success:!0,unauthorized:!1,products:r.data}:r.code===c.TOKEN_EXPIRED||r.code===c.TOKEN_FAIL?(a(),{success:!1,unauthorized:!0,message:"Token inválido o expirado"}):{success:!1,unauthorized:!1,message:"Error al obtener los datos!"}}catch(r){return{success:!1,unauthorized:!1,message:r.message}}}async function i(e,r,t,d,f){try{const u=await g(s,e,r,t,d,f);return u.code===c.DB_QUERY_SUCCESS?{success:!0,unauthorized:!1,products:u.data}:u.code===c.TOKEN_EXPIRED||u.code===c.TOKEN_FAIL?(a(),{success:!1,unauthorized:!0,message:"Token inválido o expirado"}):{success:!1,unauthorized:!1,message:"Error al agregar el producto!"}}catch(u){return{success:!1,unauthorized:!1,message:u.message}}}return{getProductList:o,delProduct:n,addProduct:i}}export{z as u};
