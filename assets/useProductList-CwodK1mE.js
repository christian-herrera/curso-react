import{i as d,A as t,u as E}from"./index-DLT7p-be.js";function p(r){if(!r||typeof r!="object"||typeof r.code>"u"||typeof r.message>"u"||typeof r.data>"u")throw new Error("Respuesta inválida del servidor!");return r}async function m(r,a,o=5e3){try{const s=await d.post("https://curso-react.christianherrera.com.ar/public/products/list.json",{timeout:o});return{code:t.DB_QUERY_SUCCESS,message:"Consulta exitosa",data:{products:s.data,total_pages:1,page:1}}}catch(s){throw new Error("Error en el servicio: "+s.message)}}async function g(r,a,o=5e3){try{const n=(await d.post("https://curso-react.christianherrera.com.ar/public/products/list.json",{timeout:o})).data.filter(i=>i.title.toLowerCase().includes(r.toLowerCase()));return{code:t.DB_QUERY_SUCCESS,message:"Consulta exitosa",data:n}}catch(s){throw new Error("Error en el servicio: "+s.message)}}async function y(r,a,o=5e3){try{const s=await d.post("https://curso-react.christianherrera.com.ar/delete-product",{id:a},{timeout:o,headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});return p(s.data)}catch(s){throw new Error("Error en el servicio: "+s.message)}}async function S(r,a,o,s,n,i,c=5e3){try{const e=new FormData;e.append("title",a),e.append("subtitle",o),e.append("description",s),e.append("price",n),e.append("image",i);const l=await d.post("https://curso-react.christianherrera.com.ar/add-product",e,{timeout:c,headers:{"Content-Type":"multipart/form-data; charset=UTF-8",Authorization:`Bearer ${r}`}});return p(l.data)}catch(e){throw new Error("Error en el servicio: delProductService"+e.message)}}function _(){const{token:r,onTokenExpired:a}=E();async function o(c){try{let e=await m(c,r);return e.code===t.DB_QUERY_SUCCESS?{success:!0,unauthorized:!1,data:e.data}:e.code===t.TOKEN_EXPIRED||e.code===t.TOKEN_FAIL?(a(),{success:!1,unauthorized:!0,message:"Token inválido o expirado"}):{success:!1,unauthorized:!1,message:"Error al obtener los datos!"}}catch(e){return{success:!1,unauthorized:!1,message:e.message}}}async function s(c){try{const e=await y(r,c);return e.code===t.DB_QUERY_SUCCESS?{success:!0,unauthorized:!1,products:e.data}:e.code===t.TOKEN_EXPIRED||e.code===t.TOKEN_FAIL?(a(),{success:!1,unauthorized:!0,message:"Token inválido o expirado"}):{success:!1,unauthorized:!1,message:"Error al obtener los datos!"}}catch(e){return{success:!1,unauthorized:!1,message:e.message}}}async function n(c,e,l,f,h){try{const u=await S(r,c,e,l,f,h);return u.code===t.DB_QUERY_SUCCESS?{success:!0,unauthorized:!1,products:u.data}:u.code===t.TOKEN_EXPIRED||u.code===t.TOKEN_FAIL?(a(),{success:!1,unauthorized:!0,message:"Token inválido o expirado"}):{success:!1,unauthorized:!1,message:"Error al agregar el producto!"}}catch(u){return{success:!1,unauthorized:!1,message:u.message}}}async function i(c){try{let e=await g(c,r);return e.code===t.DB_QUERY_SUCCESS?{success:!0,unauthorized:!1,data:e.data}:e.code===t.TOKEN_EXPIRED||e.code===t.TOKEN_FAIL?(a(),{success:!1,unauthorized:!0,message:"Token inválido o expirado"}):{success:!1,unauthorized:!1,message:"Error al obtener los datos!"}}catch(e){return{success:!1,unauthorized:!1,message:e.message}}}return{getProductList:o,delProduct:s,addProduct:n,getProductsWithQuery:i}}export{_ as u};
